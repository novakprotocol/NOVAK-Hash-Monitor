<!-- âœ… NOVAK Protocol â€” Final Public Demo Build (PART 1 of 8) -->
<!-- Do NOT modify â€” paste Parts 1â€“8 sequentially into one index.html file -->

<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NOVAK Protocol â€” Proof-Before-Action Integrity</title>
<meta name="description" content="NOVAK Protocol â€” execution integrity, fraud prevention, cryptographic proof-before-action verification for government, finance, healthcare, AI, robotics, and national security." />
<link rel="icon" type="image/png" href="favicon.png" />

<!-- âœ… Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet" />

<style>
/* ============================================================================ */
/* âœ… GLOBAL RESET + TYPOGRAPHY */
/* ============================================================================ */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "Inter", sans-serif;
}

body {
  background: var(--bg);
  color: var(--text);
  line-height: 1.55;
  -webkit-font-smoothing: antialiased;
}

.container {
  max-width: 1100px;
  margin: 0 auto;
  padding: 24px;
}

/* ============================================================================ */
/* âœ… COLOR SYSTEM â€” THEME VARIABLES */
/* ============================================================================ */
:root {
  --blue: #1a4fb3;
  --blue-hover: #0f357f;
  --green: #059669;
  --red: #dc2626;
  --yellow: #e8b400;

  --bg-light: #f8fafc;
  --bg-dark: #0f172a;

  --text-light: #0b1326;
  --text-dark: #e6edf5;

  --card-light: #ffffff;
  --card-dark: #1e293b;

  --border-light: #d4d8e1;
  --border-dark: #334155;
}

/* Light Mode */
html[data-theme="light"] {
  --bg: var(--bg-light);
  --text: var(--text-light);
  --card: var(--card-light);
  --border: var(--border-light);
}

/* Dark Mode */
html[data-theme="dark"] {
  --bg: var(--bg-dark);
  --text: var(--text-dark);
  --card: var(--card-dark);
  --border: var(--border-dark);
}

/* ============================================================================ */
/* âœ… STICKY HEADER â€” ALWAYS VISIBLE */
/* ============================================================================ */
#mainHeader {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 18px 32px;
  background: var(--bg);
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  z-index: 9999;
}

#novakBrand {
  font-size: 26px;
  font-weight: 700;
  color: var(--blue);
  white-space: nowrap;
  user-select: none;
}

/* Desktop Controls */
#headerControls {
  display: flex;
  align-items: center;
  gap: 14px;
}

.theme-toggle {
  cursor: pointer;
  font-size: 14px;
  padding: 7px 14px;
  border-radius: 6px;
  border: 1px solid var(--blue);
  background: transparent;
  color: var(--blue);
  transition: 0.25s;
}

.theme-toggle:hover {
  background: var(--blue);
  color: #fff;
}

/* Mobile Menu Button */
#mobileMenuBtn {
  display: none;
  font-size: 28px;
  background: none;
  border: none;
  cursor: pointer;
}

/* Mobile Dropdown */
#mobileMenuPanel {
  display: none;
  flex-direction: column;
  background: var(--bg);
  border-bottom: 1px solid var(--border);
  padding: 14px 22px;
  gap: 10px;
}

/* ============================================================================ */
/* âœ… CARDS, TYPOGRAPHY, SHARED UI */
/* ============================================================================ */
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 26px;
  margin-top: 26px;
}

.section-title {
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 14px;
}

/* ============================================================================ */
/* âœ… ACCESSIBILITY */
/* ============================================================================ */
:focus-visible {
  outline: 3px solid var(--blue);
  border-radius: 6px;
}

/* ============================================================================ */
/* âœ… MOBILE RESPONSIVENESS */
/* ============================================================================ */
@media (max-width: 720px) {
  #headerControls {
    display: none;
  }
  #mobileMenuBtn {
    display: block;
  }
  #novakBrand {
    font-size: 22px;
  }
  .container {
    padding: 18px;
  }
}
</style>
</head>

<body>

<!-- âœ… GLOBAL HEADER -->
<header id="mainHeader">
  <div id="novakBrand">NOVAK Protocol</div>

  <a href="http://www.novakprotocol.com"
     target="_blank"
     rel="noopener noreferrer"
     style="font-size:15px; color:var(--blue); text-decoration:none;">
    www.novakprotocol.com
  </a>

  <div id="headerControls">
    <button class="theme-toggle" onclick="toggleTheme()">Light/Dark</button>
  </div>

  <button id="mobileMenuBtn" onclick="toggleMobileMenu()">â˜°</button>
</header>

<!-- âœ… MOBILE DROPDOWN MENU -->
<div id="mobileMenuPanel">
  <button class="theme-toggle" onclick="toggleTheme()">Light/Dark Mode</button>
</div>

<!-- âœ… MAIN PAGE CONTENT BEGINS -->
<div class="container">

 <!-- âœ… PART 2 of 8 â€” Audience Selector + Dynamic Messaging + Why NOVAK -->

<!-- âœ… AUDIENCE SELECTOR â€” updates the entire site instantly -->
<div id="audienceNav" style="display:flex; gap:10px; margin-top:32px; flex-wrap:wrap;">
  <button id="btn-public" class="aud-btn" onclick="setAudience('public')">ğŸŒ Public</button>
  <button id="btn-government" class="aud-btn" onclick="setAudience('government')">ğŸ› Government</button>
  <button id="btn-investor" class="aud-btn" onclick="setAudience('investor')">ğŸ’¼ Investor</button>
  <button id="btn-cyber" class="aud-btn" onclick="setAudience('cyber')">ğŸ›¡ Cybersecurity</button>
  <button id="btn-academic" class="aud-btn" onclick="setAudience('academic')">ğŸ“ Academic</button>
</div>

<!-- âœ… AUDIENCE MESSAGING OUTPUT â€” auto-updates on click -->
<div id="audienceContent"
     class="card"
     style="margin-top:18px; font-size:16px; line-height:1.55;">
</div>

<!-- âœ… RESTORE WHY NOVAK BUTTON â€” only appears if user hides section -->
<div style="display:flex; justify-content:center; margin-top:10px;">
  <button id="restoreWhyBtn"
    onclick="restoreWhyNovakSection()"
    style="
      display:none;
      padding:8px 18px;
      border-radius:8px;
      border:1px solid var(--border);
      background:var(--btn-bg);
      cursor:pointer;
      font-size:14px;
    ">
    ğŸ”„ Show â€œWhy NOVAK â€” Why Now?â€
  </button>
</div>

<!-- âœ… WHY NOVAK â€” WHY NOW? (Dismissible, Persisted in LocalStorage) -->
<div id="whyNovakCard" class="card" style="margin-top:28px; position:relative;">
  <h2 class="section-title">Why NOVAK â€” Why Now?</h2>

  <p>
    Automation now approves mortgages, denies veteransâ€™ benefits, sets insurance rates, steers vehicles,
    recommends surgeries, and moves trillions of dollars â€” often without proof of correctness, legality, or integrity.
  </p>

  <p style="margin-top:12px;">
    NOVAK changes this â€” requiring mathematical proof <strong>before</strong> any automated action occurs.
  </p>

  <ul style="margin-top:12px; margin-left:20px;">
    <li>If data changes â†’ NOVAK detects instantly</li>
    <li>If rule is wrong â†’ NOVAK blocks execution</li>
    <li>If fraud occurs â†’ NOVAK produces evidence</li>
    <li>If system glitches â†’ NOVAK prevents harm</li>
  </ul>

  <p style="margin-top:14px; font-weight:600;">
    No blockchain. No cryptocurrency. No central authority. Just cryptographic integrity.
  </p>

  <!-- âœ… Top-right close button -->
  <button onclick="dismissWhyNovak()"
    style="
      position:absolute;
      top:14px;
      right:14px;
      background:none;
      border:none;
      font-size:20px;
      cursor:pointer;
    "
    aria-label="Hide Why NOVAK section">
    âœ•
  </button>

  <!-- âœ… User confirmation button -->
  <button onclick="dismissWhyNovak()"
          class="action-btn"
          style="margin-top:18px;">
    âœ… Got it â€” Hide
  </button>
</div>

<!-- âœ… EXPLAINER BUTTON ROW (Simple, Person-friendly Explain Modes) -->
<div style="margin-top:26px; display:flex; flex-wrap:wrap; gap:12px;">
  <button class="explain-btn" onclick="showExplain('simple')">ğŸ¤¯ I don't get it</button>
  <button class="explain-btn" onclick="showExplain('milkshake')">ğŸ¥¤ Milkshake Analogy</button>
  <button class="explain-btn" onclick="showExplain('pencil')">ğŸ–ï¸ Colored Pencil Analogy</button>
  <button class="explain-btn" onclick="showExplain('key')">ğŸ”‘ Key Analogy</button>
  <button class="explain-btn" onclick="showExplain('gov')">ğŸ›ï¸ Government Savings</button>
  <button class="explain-btn" onclick="showExplain('how')">ğŸ‘ï¸ Show Me How This Works</button>
</div>

<!-- âœ… OUTPUT CONTAINER FOR ANALOGIES & EXPLAINERS -->
<div id="explainerOutput" class="card" style="display:none; margin-top:22px;"></div>
 
<!-- âœ… PART 3 of 8 â€” What Changes With NOVAK? -->
<div id="whatChangesCard" class="card" style="margin-top:32px; position:relative;">
  <h2 class="section-title">What Changes With NOVAK?</h2>

  <p>
    Most systems today rely on logging <strong>after</strong> something already happened.
    NOVAK requires proof <strong>before</strong> action.
  </p>

  <div style="margin-top:14px;">
    <p style="color:var(--red); font-weight:600; margin-bottom:6px;">âŒ Without NOVAK</p>
    <p style="margin-bottom:14px;">
      System executes even if data is wrong â€” Hash exists but cannot stop harm â€” Fraud discovered weeks or years later â€”
      No mathematical guarantee of legality â€” Human trust required.
    </p>

    <p style="color:var(--green); font-weight:600; margin-bottom:6px;">âœ… With NOVAK</p>
    <p>
      Proof required before action â€” Data, rules & output cryptographically bound â€”
      Fraud blocked instantly â€” Evidence auto-generated â€”
      Trust replaced with math.
    </p>
  </div>

  <!-- âœ… Close X button -->
  <button onclick="dismissWhatChanges()" style="
    position:absolute;
    top:14px;
    right:14px;
    font-size:20px;
    background:none;
    border:none;
    cursor:pointer;
  " aria-label="Hide What Changes With NOVAK">âœ•</button>

  <!-- âœ… User confirmation button -->
  <button class="action-btn" onclick="dismissWhatChanges()" style="margin-top:18px;">
    âœ… Got it â€” Hide
  </button>
</div>

<!-- âœ… Restore button (only appears after dismiss) -->
<div style="display:flex; justify-content:center; margin-top:10px;">
  <button id="restoreWhatBtn"
    onclick="restoreWhatChangesSection()"
    style="
      display:none;
      padding:8px 18px;
      border-radius:8px;
      border:1px solid var(--border);
      background:var(--btn-bg);
      cursor:pointer;
      font-size:14px;
    ">
    ğŸ”„ Show â€œWhat Changes With NOVAK?â€
  </button>
</div>

 <!-- âœ… PART 4 of 8 â€” Input, Live Hashing Engine, RGAC & File Integrity -->

<!-- âœ… USER INPUT TEXTAREA -->
<div class="card" style="margin-top:32px;">
  <h2 class="section-title">Try It â€” Prove Integrity Yourself</h2>
  <p>
    Type, paste, or edit anything below. Hashes update instantly using real cryptography â€”
    nothing is stored, logged, or transmitted.
  </p>

  <textarea id="novakInput"
    placeholder="Example: VA claim, invoice, medical note, VIN, contract, JSON, SQL, XML..."
    style="width:100%; height:170px; margin-top:16px; font-family:'JetBrains Mono', monospace; font-size:14px; padding:12px;">
  </textarea>
</div>

<!-- âœ… LIVE HASH OUTPUT -->
<div class="card" style="margin-top:20px;">
  <h3 class="section-title" style="font-size:20px;">Cryptographic Hashes</h3>

  <div id="hashOutputList"
       style="margin-top:10px; font-family:'JetBrains Mono', monospace; font-size:14px;">
    <em>Waiting for input from above...</em>
  </div>
</div>

<!-- âœ… RGAC MINI-CHAIN VISUALIZATION -->
<div class="card" style="margin-top:20px;">
  <h3 class="section-title" style="font-size:20px;">RGAC â€” Recursive Global Audit Chain</h3>
  <p style="margin-bottom:12px;">
    Each output becomes input to the next verification â€” forming an unstoppable integrity chain.
  </p>
  <div id="rgac" style="font-family:'JetBrains Mono', monospace; font-size:14px;">
    <em>Provide input to begin...</em>
  </div>
</div>

<!-- âœ… FILE INTEGRITY VERIFICATION -->
<div class="card" style="margin-top:20px;">
  <h3 class="section-title" style="font-size:20px;">Verify Any File</h3>
  <p>Drop a document, medical record, CSV, log, policy, or contract â€” NOVAK proves originality instantly.</p>

  <div id="dropzone"
       style="margin-top:14px; padding:22px; border:2px dashed var(--border); border-radius:10px; text-align:center; cursor:pointer;">
    ğŸ“ Drop file here or click to select
    <input id="fileInput" type="file" style="display:none" />
  </div>

  <div id="fileHashResult"
       style="margin-top:16px; font-family:'JetBrains Mono', monospace; font-size:14px;"></div>
</div>

<!-- âœ… PART 5 of 8 â€” Example Datasets + VIN Decoder Modal -->

<!-- âœ… EXAMPLE DATASETS CARD -->
<div class="card" style="margin-top:32px;">
  <h2 class="section-title">Example Datasets</h2>
  <p>Select one to auto-populate the input box above.</p>

  <div style="display:flex; flex-wrap:wrap; gap:12px; margin-top:16px;">
    <button class="explain-btn" onclick="loadExample('va')">ğŸ–ï¸ VA Disability Claim</button>
    <button class="explain-btn" onclick="loadExample('medical')">ğŸ¥ Medical Note</button>
    <button class="explain-btn" onclick="loadExample('finance')">ğŸ’° Financial Transaction</button>
    <button class="explain-btn" onclick="loadExample('robot')">ğŸ¤– Robotics Command</button>
    <button class="explain-btn" onclick="loadExample('ai')">ğŸ§  AI System Log</button>
    <button class="explain-btn" onclick="loadExample('legal')">âš–ï¸ Legal Filing</button>
    <button class="explain-btn" onclick="openVinModal()">ğŸš— 2022 Corvette VIN</button>
  </div>
</div>

<!-- âœ… VIN DECODER MODAL -->
<div id="vinModal"
     style="display:none; position:fixed; top:0; left:0; width:100%; height:100%;
            background:rgba(0,0,0,.55); justify-content:center; align-items:center; z-index:9999;">
  <div style="background:var(--card); padding:26px; border-radius:10px; width:440px;
              border:1px solid var(--border); box-shadow:0 4px 18px rgba(0,0,0,.35);">

    <h3 class="section-title" style="font-size:20px;">2022 Corvette VIN Decoder</h3>

    <input id="vinInput"
           placeholder="Enter VIN (e.g., 1G1YB3D46N5123456)"
           maxlength="17"
           style="margin-top:14px; width:100%; padding:10px;
                  border:1px solid var(--border); border-radius:6px;
                  font-family:'JetBrains Mono', monospace; font-size:15px;">

    <div id="vinResult"
         style="margin-top:16px; font-family:'JetBrains Mono', monospace; font-size:14px;"></div>

    <button onclick="closeVinModal()" class="action-btn" style="margin-top:18px; width:100%;">
      Close
    </button>
  </div>
</div>

<!-- âœ… PART 6 of 8 â€” Interactive NOVAK Mini-Games -->

<div class="card" style="margin-top:32px;">
  <h2 class="section-title">Interactive Integrity Challenges</h2>
  <p>Prove you understand NOVAK â€” spot corruption, detect tampering, or validate authenticity.</p>

  <div style="display:flex; flex-wrap:wrap; gap:12px; margin-top:16px;">
    <button class="explain-btn" onclick="startGame('tamper')">ğŸ•µï¸ Spot the Tampering</button>
    <button class="explain-btn" onclick="startGame('memory')">ğŸ§  Hash Memory Match</button>
    <button class="explain-btn" onclick="startGame('fraud')">ğŸš¨ Fraud Detector</button>
  </div>

  <!-- âœ… Sound toggle (default OFF) -->
  <button onclick="toggleSound()"
          class="sound-toggle"
          aria-label="Toggle game sound"
          style="margin-top:10px; font-size:20px; background:none; border:none; cursor:pointer;">
    ğŸ”‡
  </button>
</div>

<!-- âœ… Dynamic game container -->
<div id="gameBox" class="card" style="margin-top:20px; display:none;"></div>

<!-- âœ… PART 7 of 8 â€” Data Validation, Transparency & Integrity Receipt -->

<!-- âœ… STRUCTURED DATA VALIDATION -->
<div class="card" style="margin-top:32px;">
  <h2 class="section-title">Validate Structured Data</h2>
  <p>Upload JSON, SQL, or XML â€” NOVAK verifies integrity instantly before execution.</p>

  <input id="structuredFile"
         type="file"
         accept=".json,.sql,.xml,.txt"
         style="margin-top:16px;">

  <pre id="structuredResult"
       style="margin-top:16px; font-family:'JetBrains Mono', monospace; font-size:14px;"></pre>
</div>

<!-- âœ… AI TRANSPARENCY MODE -->
<div class="card" style="margin-top:32px;" id="transparencyCard">
  <h2 class="section-title">AI Transparency Mode</h2>
  <p>
    AI decisions should not be mysterious â€” NOVAK proves what data, rules, and outputs were used
    before action occurs.
  </p>
  <ul style="margin-top:12px; margin-left:20px;">
    <li>âœ… Prevents silent AI overrides</li>
    <li>âœ… Detects manipulated prompts or inputs</li>
    <li>âœ… Creates verifiable execution receipts</li>
    <li>âœ… Ensures lawful + ethical automation</li>
  </ul>

  <button onclick="toggleTransparency()"
          class="action-btn"
          style="margin-top:16px;">
    Enable Transparency View
  </button>
</div>

<!-- âœ… HIDDEN PANEL â€” becomes visible when transparency mode enabled -->
<div class="card"
     id="transparencyView"
     style="display:none; margin-top:20px; font-family:'JetBrains Mono', monospace; font-size:14px;">
</div>

<!-- âœ… PERSISTENT EXECUTION RECEIPT -->
<div class="card" style="margin-top:32px;" id="receiptCard">
  <h2 class="section-title">Integrity Receipt</h2>
  <p>
    NOVAK issues a tamper-proof receipt so you can prove what existed, when,
    and under what rules.
  </p>

  <button class="action-btn" onclick="generateReceipt()" style="margin-top:12px;">
    Generate Receipt
  </button>

  <pre id="receiptOutput"
       style="margin-top:16px; font-family:'JetBrains Mono', monospace; font-size:14px; white-space:pre-wrap;"></pre>
</div>

 <!-- âœ… PART 8 of 8 â€” Guided Demo + Federal Briefing Sheet Export -->

<!-- âœ… AUTO-SCROLL STORY MODE -->
<div class="card" style="margin-top:36px;">
  <h2 class="section-title">Guided NOVAK Walkthrough</h2>
  <p>Let NOVAK teach itself â€” step-by-step, automatically.</p>

  <button class="action-btn"
          onclick="startStoryMode()"
          style="margin-top:12px;">
    â–¶ Begin Guided Demo
  </button>
</div>

<!-- âœ… STORY MODE TEXT PANEL -->
<div id="storyPanel"
     class="card"
     style="display:none; margin-top:20px; font-size:15px; line-height:1.6;">
</div>

<!-- âœ… DOJ / FEDERAL BRIEFING SHEET GENERATOR -->
<div class="card" style="margin-top:36px;">
  <h2 class="section-title">Generate Federal Briefing Sheet</h2>
  <p>
    Exports a clean, formal one-page NOVAK summary
    for policymakers, agency leadership, or executive briefings.
  </p>

  <button class="action-btn"
          onclick="exportBriefing()"
          style="margin-top:12px;">
    ğŸ“„ Export Briefing Sheet
  </button>
</div>
 
<script>
// ================================================================
// âœ… GLOBAL STATE
// ================================================================
let currentAudience = "public";
let soundEnabled = false;
let storyIndex = 0;
let storyInterval;

// ================================================================
// âœ… THEME TOGGLE â€” Light / Dark
// ================================================================
function toggleTheme() {
  const html = document.documentElement;
  const newTheme = html.getAttribute("data-theme") === "light" ? "dark" : "light";
  html.setAttribute("data-theme", newTheme);
  localStorage.setItem("novakTheme", newTheme);
}

// Restore saved theme on load
(function () {
  const saved = localStorage.getItem("novakTheme");
  if (saved) document.documentElement.setAttribute("data-theme", saved);
})();

// ================================================================
// âœ… MOBILE MENU
// ================================================================
function toggleMobileMenu() {
  const m = document.getElementById("mobileMenuPanel");
  m.style.display = m.style.display === "flex" ? "none" : "flex";
}

// ================================================================
// âœ… AUDIENCE ENGINE â€” Updates Messaging Across Page
// ================================================================
const audienceMessages = {
  public: `NOVAK protects everyday people â€” ensuring decisions about healthcare, housing, credit, prices, education,
safety, transportation, and employment cannot be corrupted, miscalculated, or executed without proof.`,

  government: `NOVAK reduces fraud, waste, improper payments, wrongful denials, and mission-threatening automation
failure â€” without requiring new agencies, new infrastructure, or new laws. Execution integrity becomes default.`,

  investor: `NOVAK creates a new global integrity layer â€” reducing enterprise risk, increasing claim defensibility, enabling
provable AI products, and unlocking trillion-dollar modernization markets in government, finance & healthcare.`,

  cyber: `NOVAK adds a missing pillar to cybersecurity â€” prevention. No blockchain, no consensus, no latency. Just
mathematical proof that data, rules & output have not changed â€” before execution is allowed.`,

  academic: `NOVAK applies deterministic computation, cryptographic binding, verifiable receipts, and recursive
auditability to eliminate epistemic uncertainty in automated decision systems â€” at global scale.`
};

function setAudience(type) {
  currentAudience = type;
  document.getElementById("audienceContent").textContent = audienceMessages[type];

  document.querySelectorAll(".aud-btn").forEach(btn => btn.classList.remove("active"));
  document.getElementById(`btn-${type}`).classList.add("active");
}

// ================================================================
// âœ… WHY NOVAK â€” DISMISS & RESTORE
// ================================================================
function dismissWhyNovak() {
  document.getElementById("whyNovakCard").style.display = "none";
  document.getElementById("restoreWhyBtn").style.display = "inline-flex";
  localStorage.setItem("whyNovakDismissed", "true");
}

function restoreWhyNovakSection() {
  document.getElementById("whyNovakCard").style.display = "block";
  document.getElementById("restoreWhyBtn").style.display = "none";
  localStorage.removeItem("whyNovakDismissed");
}

function restoreWhyNovakOnLoad() {
  if (localStorage.getItem("whyNovakDismissed") === "true") {
    dismissWhyNovak();
  }
}

// ================================================================
// âœ… WHAT CHANGES WITH NOVAK â€” DISMISS & RESTORE
// ================================================================
function dismissWhatChanges() {
  document.getElementById("whatChangesCard").style.display = "none";
  document.getElementById("restoreWhatBtn").style.display = "inline-flex";
  localStorage.setItem("whatChangesDismissed", "true");
}

function restoreWhatChangesSection() {
  document.getElementById("whatChangesCard").style.display = "block";
  document.getElementById("restoreWhatBtn").style.display = "none";
  localStorage.removeItem("whatChangesDismissed");
}

function restoreWhatChangesOnLoad() {
  if (localStorage.getItem("whatChangesDismissed") === "true") {
    dismissWhatChanges();
  }
}

// ================================================================
// âœ… EXPLAINER SYSTEM
// ================================================================
const explainTexts = {
  simple: "NOVAK is like requiring a receipt before spending, not after â€” machines must prove correctness first.",
  milkshake: "If a milkshake spills, it's obvious â€” but in data systems, corruption is invisible until NOVAK reveals it.",
  pencil: "You can't un-color a page without leaving marks. NOVAK ensures digital changes always leave evidence.",
  key: "A house key doesn't open every door â€” NOVAK ensures only correct data unlocks execution.",
  gov: "NOVAK could save government billions by preventing improper payments before they occur.",
  how: "NOVAK binds input, rule, and output together â€” if anything changes, execution is cryptographically blocked."
};

function showExplain(key) {
  const box = document.getElementById("explainerOutput");
  box.style.display = "block";
  box.textContent = explainTexts[key] || "Explanation unavailable.";
  box.scrollIntoView({ behavior: "smooth" });
}

// ================================================================
// âœ… REAL HASH ENGINE â€” Live, Math-Accurate
// ================================================================
async function computeHash(algorithm, value) {
  const data = typeof value === "string"
    ? new TextEncoder().encode(value)
    : new Uint8Array(value);

  const digest = await crypto.subtle.digest(algorithm, data);

  return Array.from(new Uint8Array(digest))
    .map(b => b.toString(16).padStart(2, "0"))
    .join("");
}

async function updateHashes() {
  const input = document.getElementById("novakInput").value.trim();
  const list = document.getElementById("hashOutputList");

  if (!input) {
    list.innerHTML = "<em>Waiting for input from above...</em>";
    document.getElementById("rgac").innerHTML = "<em>Provide input to begin...</em>";
    return;
  }

  const algorithms = ["SHA-256", "SHA-512", "SHA-384", "SHA3-256"];
  list.innerHTML = "";

  for (const algo of algorithms) {
    const hash = await computeHash(algo, input);
    list.innerHTML += `
      <div style="display:flex; align-items:center; gap:10px; margin-bottom:6px;">
        <strong>${algo}:</strong>
        <span style="font-family:'JetBrains Mono', monospace;">${hash}</span>
        <button style="padding:2px 6px;" onclick="navigator.clipboard.writeText('${hash}')">Copy</button>
      </div>
    `;
  }

  updateRGAC(input);
}

document.getElementById("novakInput")?.addEventListener("input", updateHashes);

// ================================================================
// âœ… RGAC â€” Recursive Global Audit Chain Animation
// ================================================================
function updateRGAC(value) {
  const rgac = document.getElementById("rgac");

  if (!value.trim()) {
    rgac.innerHTML = "<em>Provide input to begin...</em>";
    return;
  }

  const segments = ["Data", "Rule", "Output", "Verifier", "Receipt"];
  rgac.innerHTML = segments
    .map((label, i) => `<div class="block">${label} #${i + 1}</div>`)
    .join("");
}

// ================================================================
// âœ… FILE HASH VERIFICATION
// ================================================================
const dropzone = document.getElementById("dropzone");
const fileInput = document.getElementById("fileInput");
const fileHashResult = document.getElementById("fileHashResult");

dropzone?.addEventListener("click", () => fileInput.click());

dropzone?.addEventListener("dragover", e => {
  e.preventDefault();
  dropzone.style.background = "rgba(26,79,179,0.07)";
});

dropzone?.addEventListener("dragleave", () => dropzone.style.background = "transparent");

dropzone?.addEventListener("drop", e => {
  e.preventDefault();
  dropzone.style.background = "transparent";
  handleFileHash(e.dataTransfer.files[0]);
});

fileInput?.addEventListener("change", e => handleFileHash(e.target.files[0]));

async function handleFileHash(file) {
  if (!file) return;
  const arrayBuffer = await file.arrayBuffer();
  const hash = await computeHash("SHA-256", arrayBuffer);

  fileHashResult.innerHTML = `âœ… <strong>${file.name}</strong><br>SHA-256: <code>${hash}</code>`;
}

// ================================================================
// âœ… VIN DECODER
// ================================================================
function openVinModal() {
  document.getElementById("vinModal").style.display = "flex";
}

function closeVinModal() {
  document.getElementById("vinModal").style.display = "none";
}

function decodeCorvetteVIN(vin) {
  if (vin.length !== 17) return "âŒ VIN must be 17 characters";

  const year = { N: 2022 }[vin[9]] || "Unknown";
  const plant = { "5": "Bowling Green, Kentucky" }[vin[10]] || "Unknown";
  const model = vin.startsWith("1G1Y") ? "Chevy Corvette Stingray" : "Unknown Model";

  return `Model: ${model}\nModel Year: ${year}\nAssembly Plant: ${plant}\nSequence: ${vin.slice(11)}`;
}

document.getElementById("vinInput")?.addEventListener("input", () => {
  document.getElementById("vinResult").innerHTML =
    `<pre>${decodeCorvetteVIN(vinInput.value.trim())}</pre>`;
});

// ================================================================
// âœ… MINI-GAMES â€” Spot Tampering, Memory, Fraud
// ================================================================
function toggleSound() {
  soundEnabled = !soundEnabled;
  document.querySelector(".sound-toggle").textContent = soundEnabled ? "ğŸ”Š" : "ğŸ”‡";
}

function startGame(type) {
  document.getElementById("gameBox").style.display = "block";

  if (type === "tamper") return gameTamper();
  if (type === "memory") return gameMemory();
  if (type === "fraud") return gameFraud();
}

// --- Game 1: Spot Tampering ---
function gameTamper() {
  const original = "Approved VA Claim â€” Rating 70% â€” 2025-03-14";
  const tampered = "Approved VA Claim â€” Rating 10% â€” 2025-03-14";

  document.getElementById("gameBox").innerHTML = `
    <h3>ğŸ•µï¸ Spot the Tampering</h3>
    <p>Two records â€” one is altered. Which one fails integrity?</p>

    <pre>${original}</pre>
    <pre>${tampered}</pre>

    <div style="display:flex; gap:10px; margin-top:14px;">
      <button class="action-btn" onclick="checkTamper(true)">Top is Original âœ…</button>
      <button class="action-btn" onclick="checkTamper(false)">Bottom is Original âœ…</button>
    </div>

    <div id="tamperResult" style="margin-top:16px;font-weight:600;"></div>
  `;
}

function checkTamper(choice) {
  const result = document.getElementById("tamperResult");
  if (choice) result.textContent = "âœ… Correct â€” NOVAK detects rating manipulation instantly.";
  else result.textContent = "âŒ Incorrect â€” silent benefit reduction could occur without NOVAK.";
}

// ================================================================
// âœ… STRUCTURED DATA VALIDATION â€” JSON, XML, SQL
// ================================================================
document.getElementById("structuredFile")?.addEventListener("change", async e => {
  const file = e.target.files[0];
  if (!file) return;

  const txt = await file.text();
  const hash = await computeHash("SHA-256", txt);

  document.getElementById("structuredResult").innerHTML =
    `âœ… File loaded â€” integrity proven\n\nSHA-256: ${hash}`;
});

// ================================================================
// âœ… AI TRANSPARENCY VIEW
// ================================================================
function toggleTransparency() {
  const panel = document.getElementById("transparencyView");
  panel.style.display = panel.style.display === "none" ? "block" : "none";

  panel.innerHTML =
    `DATA âœ RULE âœ OUTPUT\n\nMathematically bound, cryptographically verified.`;
}

// ================================================================
// âœ… EXECUTION RECEIPT GENERATOR
// ================================================================
async function generateReceipt() {
  const input = document.getElementById("novakInput").value.trim();
  if (!input) return alert("Enter something first!");

  const sha = await computeHash("SHA-256", input);
  const timestamp = new Date().toISOString();

  document.getElementById("receiptOutput").textContent =
`NOVAK Execution Integrity Receipt
----------------------------------
Timestamp: ${timestamp}
SHA-256: ${sha}

This proves what existed, when, and under what rules.`;
}

// ================================================================
// âœ… Guided Auto-Scroll Story Mode
// ================================================================
const storySlides = [
  "Welcome â€” NOVAK fixes the world's most dangerous hidden problem: automation without proof.",
  "Today, software approves loans, surgeries, veteran benefits, procurement, sentencing â€” without verification.",
  "NOVAK requires mathematical integrity â€” BEFORE execution â€” preventing irreversible harm.",
  "Hashes alone don't stop fraud. NOVAK chains data, rules & outputs into a verifiable execution receipt.",
  "If anything changes â€” fraud, glitch, bias, breach â€” NOVAK refuses to execute.",
  "That means government, AI, banking, healthcare & defense systems become provably trustworthy.",
  "Now try entering data above â€” NOVAK proves it instantly.",
  "NOVAK doesn't replace systems â€” it protects them.",
  "Proof-before-action becomes the new global safety standard."
];

function startStoryMode() {
  const panel = document.getElementById("storyPanel");
  panel.style.display = "block";
  storyIndex = 0;
  panel.textContent = storySlides[0];

  clearInterval(storyInterval);

  storyInterval = setInterval(() => {
    storyIndex++;
    if (storyIndex >= storySlides.length) return clearInterval(storyInterval);

    panel.textContent = storySlides[storyIndex];
    panel.scrollIntoView({ behavior: "smooth" });
  }, 4500);
}

// ================================================================
// âœ… Federal Briefing Sheet Export
// ================================================================
function exportBriefing() {
  const text =
`NOVAK Protocol â€” Executive Briefing

Mission:
Eliminate catastrophic automated decisions by requiring mathematical proof-before-action.

Why It Matters:
â€¢ Prevents wrongful benefit denials, medical errors, procurement fraud, and security breaches.
â€¢ Saves billions in improper payments and litigation.
â€¢ Enables safe, auditable AI adoption across government.

How NOVAK Works:
1. Hashes input, governing rule, and output.
2. Cryptographically binds them together.
3. Generates an execution receipt.
4. Blocks execution if anything is altered.

Not a blockchain. Not a cryptocurrency. No mining. No latency.

Applicable to:
â€¢ VA, DoD, CMS, SSA, DOJ, DHS, IRS, Treasury
â€¢ Banking, insurance, healthcare, logistics
â€¢ Robotics, autonomous vehicles, critical infrastructure

National Security Impact:
â€¢ Eliminates silent automated sabotage & insider manipulation.
â€¢ Establishes global execution integrity.

Status: Patent pending â€” NOVAK Protocolâ„¢`;

  const blob = new Blob([text], { type: "text/plain" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "NOVAK_Federal_Briefing.txt";
  a.click();

  URL.revokeObjectURL(url);
}

// ================================================================
// âœ… GLORY TO GOD EXPANDER
// ================================================================
function toggleGlorySection() {
  const box = document.getElementById("glorySection");
  const show = box.style.display === "none";

  box.style.display = show ? "block" : "none";

  if (show) box.scrollIntoView({ behavior: "smooth" });
}

// ================================================================
// âœ… INIT ON PAGE LOAD
// ================================================================
document.addEventListener("DOMContentLoaded", () => {
  setAudience("public");
  restoreWhyNovakOnLoad();
  restoreWhatChangesOnLoad();
  updateHashes();
});
</script>

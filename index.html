<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NOVAK Integrity Verification Demo</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet" />

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"Inter",sans-serif}

/* THEME COLORS */
:root{
 --blue:#1a4fb3;
 --blue-hover:#0f357f;
 --bg-light:#f8fafc;
 --bg-dark:#0f172a;
 --text-light:#0b1326;
 --text-dark:#e6edf5;
 --card-light:#ffffff;
 --card-dark:#1e293b;
 --border-light:#d4d8e1;
 --border-dark:#334155;
}

html[data-theme="light"]{
 --bg:var(--bg-light);
 --text:var(--text-light);
 --card:var(--card-light);
 --border:var(--border-light);
}
html[data-theme="dark"]{
 --bg:var(--bg-dark);
 --text:var(--text-dark);
 --card:var(--card-dark);
 --border:var(--border-dark);
}

body{
 background:var(--bg);
 color:var(--text);
 padding:36px;
}

.container{max-width:900px;margin:auto}

/* HEADER */
.header{
 display:flex;
 justify-content:space-between;
 align-items:center;
 margin-bottom:16px;
}
.logo{
 font-size:34px;
 font-weight:700;
 color:var(--blue);
}

/* THEME TOGGLE */
.theme-toggle{
 cursor:pointer;
 font-size:14px;
 border:1px solid var(--blue);
 padding:6px 12px;
 border-radius:6px;
 color:var(--blue);
 background:transparent;
 transition:.25s;
}
.theme-toggle:hover{
 background:var(--blue);
 color:white;
}

/* AUDIENCE NAV */
.nav{
 display:flex;
 justify-content:center;
 flex-wrap:wrap;
 gap:12px;
 margin:22px 0;
}
.nav button{
 border:1px solid var(--blue);
 background:transparent;
 padding:8px 16px;
 border-radius:6px;
 font-size:14px;
 cursor:pointer;
 transition:.25s;
 color:var(--blue);
}
.nav button.active,
.nav button:hover{
 background:var(--blue);
 color:white;
}

/* CARD */
.card{
 background:var(--card);
 border:1px solid var(--border);
 border-radius:10px;
 padding:22px;
 margin-top:24px;
}

/* EXAMPLE CARDS */
.example-grid{
 display:grid;
 grid-template-columns:repeat(auto-fit,minmax(230px,1fr));
 gap:18px;
 margin-top:14px;
}
.example{
 border:1px solid var(--border);
 padding:14px;
 border-radius:8px;
 cursor:pointer;
 transition:.25s;
 background:var(--card);
 font-size:14px;
}
.example:hover{
 background:rgba(26,79,179,.08);
 border-color:var(--blue);
}

/* TEXT INPUT */
textarea{
 width:100%;
 height:170px;
 border:1px solid var(--border);
 border-radius:6px;
 padding:12px;
 background:transparent;
 font-family:"JetBrains Mono",monospace;
 font-size:14px;
 color:var(--text);
 resize:vertical;
}

/* DROPZONE */
.dropzone{
 margin-top:18px;
 border:2px dashed var(--blue);
 padding:36px;
 text-align:center;
 border-radius:10px;
 cursor:pointer;
 transition:.22s;
}
.dropzone:hover{
 background:rgba(26,79,179,.07);
}

/* HASH ROW */
.hash-row{
 display:flex;
 justify-content:space-between;
 align-items:center;
 gap:8px;
 padding:8px 0;
 border-bottom:1px solid var(--border);
 font-family:"JetBrains Mono",monospace;
 font-size:13px;
}
.hash-label{
 flex:0 0 90px;
}
.hash-value{
 flex:1;
 overflow:hidden;
 text-overflow:ellipsis;
 white-space:nowrap;
}
.hash-controls{
 display:flex;
 gap:6px;
 align-items:center;
}
.copy{
 cursor:pointer;
 border:1px solid var(--blue);
 border-radius:5px;
 padding:2px 8px;
 transition:.22s;
 font-size:12px;
}
.copy:hover{
 background:var(--blue);
 color:white;
}

/* RGAC MINI VIS */
.rgac{
 display:flex;
 gap:10px;
 overflow-x:auto;
 padding:10px 0;
 margin-top:8px;
}
.block{
 padding:8px 10px;
 border:1px solid var(--blue);
 border-radius:6px;
 font-family:"JetBrains Mono",monospace;
 font-size:11px;
 white-space:nowrap;
}

/* TIMELINE */
.timeline{
 margin-top:12px;
 height:160px;
 overflow-y:auto;
 font-size:12px;
 border:1px solid var(--border);
 padding:10px;
 border-radius:6px;
 font-family:"JetBrains Mono",monospace;
 white-space:pre-wrap;
 background:rgba(26,79,179,.05);
}

/* BUTTONS */
.action-btn{
 margin-top:14px;
 margin-right:8px;
 padding:8px 16px;
 border-radius:6px;
 border:none;
 cursor:pointer;
 background:var(--blue);
 color:white;
 font-size:14px;
 transition:.25s;
}
.action-btn:hover{
 background:var(--blue-hover);
}

/* COMPARISON BOX */
.compare-box{
 margin-top:10px;
 border:1px solid var(--border);
 border-radius:6px;
 padding:10px;
 font-size:12px;
 font-family:"JetBrains Mono",monospace;
 background:rgba(15,23,42,0.3);
}
.compare-row{
 display:flex;
 justify-content:space-between;
 gap:12px;
 margin-bottom:4px;
}
.compare-label{
 flex:0 0 80px;
}
.compare-before,.compare-after{
 flex:1;
 overflow:hidden;
 text-overflow:ellipsis;
 white-space:nowrap;
}

/* FOOTER */
.footer{
 margin-top:36px;
 font-size:12px;
 text-align:center;
 opacity:.75;
}
</style>
</head>

<body>
<div class="container">

  <!-- HEADER -->
  <div class="header">
    <div class="logo">NOVAK Protocol</div>
    <button class="theme-toggle" onclick="toggleTheme()">Light/Dark</button>
  </div>

  <!-- DESCRIPTION -->
  <p id="description" style="font-size:15px;margin-bottom:20px;">
    NOVAK generates a mathematical fingerprint of data.  
    If the data changes — even slightly — the fingerprint changes instantly. Try it below.
  </p>

  <!-- AUDIENCE NAVIGATION -->
  <div class="nav">
    <button onclick="setAudience('public')" class="active" id="btn-public">Public</button>
    <button onclick="setAudience('government')" id="btn-government">Government</button>
    <button onclick="setAudience('investor')" id="btn-investor">Investor</button>
    <button onclick="setAudience('cyber')" id="btn-cyber">Cybersecurity</button>
    <button onclick="setAudience('academic')" id="btn-academic">Academic</button>
  </div>

  <!-- EXAMPLE DATASETS -->
  <div class="card">
    <h3>Select an example dataset:</h3>

    <div class="example-grid">
      <div class="example" onclick="loadExample('va')">VA Disability Claim Summary</div>
      <div class="example" onclick="loadExample('medical')">Clinical Note (Healthcare)</div>
      <div class="example" onclick="loadExample('finance')">Financial Transaction Record</div>
      <div class="example" onclick="loadExample('ai')">AI Decision Output Log</div>
      <div class="example" onclick="loadExample('robotics')">Autonomous Robotics Command</div>
      <div class="example" onclick="loadExample('legal')">Legal/Policy Directive</div>
    </div>
  </div>

  <!-- INPUT AREA -->
  <div class="card">
    <textarea id="input" placeholder="Type, paste, or modify data here..."></textarea>

    <div id="dropzone" class="dropzone">
      ⬇️ Drag & drop a file here to verify integrity
    </div>

    <button class="action-btn" onclick="tamperTest()">Run Tamper Test</button>
    <button class="action-btn" onclick="toggleCompareMode()" id="compareBtn">Start Before/After Capture</button>
  </div>

  <!-- HASH OUTPUT -->
  <div class="card">
    <h3 id="hashHeader">Integrity Fingerprints</h3>
    <p style="font-size:13px;margin-bottom:6px;">All major hashes are shown. Select which one you want to treat as the primary.</p>
    <div id="hashes"></div>

    <p style="font-size:13px;margin-top:8px;">
      Primary Hash for certificate:
      <span id="primaryLabel" style="font-weight:600;">SHA-256</span>
    </p>

    <!-- RGAC VISUALIZER -->
    <h4 style="margin-top:16px;">RGAC Chain (conceptual demo):</h4>
    <div id="rgac" class="rgac"></div>

    <button class="action-btn" onclick="exportCertificate()">Export Integrity Certificate (PDF)</button>
  </div>

  <!-- BEFORE/AFTER COMPARISON -->
  <div class="card">
    <h3>Before/After Comparison</h3>
    <p style="font-size:13px;margin-bottom:8px;">
      Click “Start Before/After Capture”, then modify the input, then click the button again to see the difference.
    </p>
    <div id="comparison" class="compare-box" style="display:none;"></div>
  </div>

  <!-- TIMELINE -->
  <div class="card" id="timelineCard">
    <h3 id="timelineHeader">Proof History</h3>
    <div id="timeline" class="timeline"></div>
  </div>

  <!-- FOOTER -->
  <div class="footer">
    NOVAK Protocol — Patent Pending © 2025.  
    Demonstration only — no data stored or transmitted off this device.
  </div>

</div>

<script>
const input = document.getElementById("input");
const hashesDiv = document.getElementById("hashes");
const rgacDiv = document.getElementById("rgac");
const timeline = document.getElementById("timeline");
const dropzone = document.getElementById("dropzone");
const primaryLabel = document.getElementById("primaryLabel");
const comparisonBox = document.getElementById("comparison");
const compareBtn = document.getElementById("compareBtn");

/* Audience messaging */
const audienceText = {
  public:{
    desc:"NOVAK generates a mathematical fingerprint of data. If anything changes—even slightly—the fingerprint changes instantly. Try it below.",
    hash:"Integrity Fingerprints",
    timeline:"Proof History"
  },
  government:{
    desc:"NOVAK enforces cryptographic proof-before-action — ensuring records, claims, and automated decisions cannot be altered without detection.",
    hash:"Regulatory Integrity Fingerprints",
    timeline:"Audit & Compliance Trail"
  },
  investor:{
    desc:"NOVAK prevents fraud, tampering, and unauthorized automation — reducing risk across healthcare, finance, defense & government.",
    hash:"Business Integrity Outputs",
    timeline:"Accountability Timeline"
  },
  cyber:{
    desc:"Real-time hashing for SOC, DFIR, DevSecOps, file integrity monitoring, and tamper detection.",
    hash:"Cryptographic Hash Outputs",
    timeline:"Security Event Timeline"
  },
  academic:{
    desc:"Hashes are deterministic, collision-resistant mathematical functions — foundational to cryptography & distributed systems.",
    hash:"Cryptographic Fingerprints",
    timeline:"Research Log"
  }
};

function setAudience(a){
  document.getElementById("description").innerText = audienceText[a].desc;
  document.getElementById("hashHeader").innerText = audienceText[a].hash;
  document.getElementById("timelineHeader").innerText = audienceText[a].timeline;
  document.querySelectorAll(".nav button").forEach(btn=>btn.classList.remove("active"));
  document.getElementById(`btn-${a}`).classList.add("active");
}

/* Example datasets */
const examples = {
  va:`Veteran: John Sample
Claim Type: Degenerative Joint Disease
Status: Pending C&P Review
Evidence: MRI confirming L5-S1 disc narrowing
Requested Rating Increase: 10% → 40%`,
  medical:`Patient DOB: 1978-02-14
Diagnosis: Atrial fibrillation
Medication Change: Metoprolol 25mg BID
Follow-Up: 6 weeks`,
  finance:`Transaction ID: 9938172-AX
Account: Commercial Checking
Amount: $248,932.17
Purpose: Federal subcontract payment`,
  ai:`Autonomous System Output:
Confidence: 0.92
Recommended Action: Approve
Input Source: Document classifier model`,
  robotics:`Command ID: R-2043
Unit: Surgical Robot Arm
Instruction: Move 3.2mm posterior
Safety Flag: TRUE`,
  legal:`Directive ID: SEC-782-A
Policy: Data Tamper Prevention
Effective: March 2025
Applies To: All automated systems`
};

function loadExample(type){
  input.value = examples[type];
  addTimeline(`Loaded example dataset: ${type}`);
  compute();
}

/* Hash algorithms to show */
const algorithms = ["SHA-1","SHA-256","SHA-384","SHA-512"];
let lastHashes = {};
let primaryHash = "SHA-256";

/* Core hashing */
async function compute(){
  const encoder = new TextEncoder();
  const data = encoder.encode(input.value);
  let rows = "";
  lastHashes = {};

  for(const algo of algorithms){
    const digest = await crypto.subtle.digest(algo,data);
    const hex = [...new Uint8Array(digest)].map(b=>b.toString(16).padStart(2,"0")).join("");
    lastHashes[algo] = hex;

    rows += `
      <div class="hash-row">
        <span class="hash-label">${algo}</span>
        <span class="hash-value">${hex}</span>
        <div class="hash-controls">
          <label style="font-size:11px;">
            <input type="radio" name="primary" value="${algo}" ${algo===primaryHash?'checked':''}
                   onclick="setPrimary('${algo}')"> primary
          </label>
          <button class="copy" onclick="navigator.clipboard.writeText('${hex}')">Copy</button>
        </div>
      </div>
    `;
  }

  hashesDiv.innerHTML = rows;
  primaryLabel.innerText = primaryHash;

  updateRGAC(lastHashes[primaryHash]);
  addTimeline("Hashes updated");
}

/* Primary hash selector */
function setPrimary(algo){
  primaryHash = algo;
  primaryLabel.innerText = primaryHash;
  addTimeline(`Primary hash set to ${primaryHash}`);
}

/* RGAC mini-chain */
let rgacBlocks = [];
function updateRGAC(hash){
  if(!hash) return;
  rgacBlocks.push(hash.slice(0,10));
  if(rgacBlocks.length>6) rgacBlocks.shift();
  rgacDiv.innerHTML = rgacBlocks.map(h=>`<div class="block">${h}</div>`).join("");
}

/* Timeline logger */
function addTimeline(msg){
  timeline.innerText += `[${new Date().toLocaleTimeString()}] ${msg}\n`;
  timeline.scrollTop = timeline.scrollHeight;
}

/* Typing triggers compute */
input.addEventListener("input", compute);

/* File drop */
dropzone.addEventListener("dragover",e=>e.preventDefault());
dropzone.addEventListener("drop",async e=>{
  e.preventDefault();
  const file = e.dataTransfer.files[0];
  if(!file) return;
  input.value = await file.text();
  addTimeline(`File loaded: ${file.name}`);
  compute();
});

/* Tamper test */
function tamperTest(){
  input.value += "\n\n*** UNAUTHORIZED CHANGE FLAGGED ***";
  addTimeline("Tamper test applied");
  compute();
}

/* Before/After comparison (inline, no popup) */
let beforeSnapshot = null;
function toggleCompareMode(){
  if(!beforeSnapshot){
    beforeSnapshot = {
      input: input.value,
      hashes: {...lastHashes},
      time: new Date().toLocaleTimeString()
    };
    compareBtn.innerText = "Complete Before/After Comparison";
    addTimeline("Captured BEFORE state — modify input, then click comparison again.");
  } else {
    const after = {
      input: input.value,
      hashes: {...lastHashes},
      time: new Date().toLocaleTimeString()
    };

    let html = `<div><strong>BEFORE:</strong> ${beforeSnapshot.time}<br><strong>AFTER:</strong> ${after.time}</div><hr style="margin:6px 0;" />`;
    for(const algo of algorithms){
      const before = beforeSnapshot.hashes[algo] || "";
      const afterVal = after.hashes[algo] || "";
      const changed = before !== afterVal;
      html += `
        <div class="compare-row">
          <span class="compare-label">${algo}</span>
          <span class="compare-before">${before || "(none)"}</span>
          <span class="compare-after" style="color:${changed?'#dc2626':''};">${afterVal || "(none)"}</span>
        </div>
      `;
    }

    comparisonBox.innerHTML = html;
    comparisonBox.style.display = "block";
    addTimeline("Before/After comparison completed.");
    compareBtn.innerText = "Start Before/After Capture";
    beforeSnapshot = null;
  }
}

/* Theme toggle */
function toggleTheme(){
  const html = document.documentElement;
  html.dataset.theme = html.dataset.theme === "dark" ? "light" : "dark";
  addTimeline(`Theme changed to ${html.dataset.theme}`);
}

/* Export Integrity Certificate (PDF) */
function exportCertificate(){
  const certificateWindow = window.open("", "_blank");
  const primaryHashValue = lastHashes[primaryHash] || "";

  certificateWindow.document.write(`
    <html>
    <head>
      <title>NOVAK Integrity Certificate</title>
      <style>
        body{ font-family: Inter, sans-serif; padding:40px; }
        h1{ color:#1a4fb3; font-size:28px; margin-bottom:8px; }
        h3{ margin-top:22px; }
        .mono{ font-family:"JetBrains Mono",monospace;font-size:13px; }
        .rgac{ margin-top:8px; }
        .block{
          display:inline-block;
          border:1px solid #1a4fb3;
          padding:6px 10px;
          margin-right:6px;
          border-radius:5px;
          font-family:"JetBrains Mono",monospace;
          font-size:11px;
        }
        footer{ margin-top:40px;font-size:12px;opacity:.7; }
      </style>
    </head>
    <body>
      <h1>NOVAK Integrity Verification Certificate</h1>

      <p>This certificate confirms the computed cryptographic integrity fingerprint
      of the provided dataset at the time of export.</p>

      <h3>Primary Hash Algorithm:</h3>
      <p>${primaryHash}</p>

      <h3>Primary Hash Value:</h3>
      <p class="mono">${primaryHashValue}</p>

      <h3>Sampled RGAC Chain:</h3>
      <div class="rgac">
        ${rgacBlocks.map(h=>`<span class="block">${h}</span>`).join("")}
      </div>

      <h3>Timestamp:</h3>
      <p>${new Date().toLocaleString()}</p>

      <h3>Audience Context:</h3>
      <p>${document.querySelector(".nav .active").innerText}</p>

      <h3>Input Data:</h3>
      <pre class="mono">${input.value.replace(/</g,"&lt;")}</pre>

      <footer>
        NOVAK Protocol — Patent Pending © 2025<br>
        Demonstration only — no data retained or transmitted.
      </footer>
    </body>
    </html>
  `);

  certificateWindow.document.close();
  certificateWindow.print();
}

/* INIT */
setAudience("public");
compute();
</script>
</body>
</html>
